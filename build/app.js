!function t(e,i,n){function r(a,s){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!s&&h)return h(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){var i=e[a][1][t];return r(i?i:t)},l,l.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e,i){"use strict";var n=function(t){switch(t.status){case Dropbox.ApiError.INVALID_TOKEN:break;case Dropbox.ApiError.NOT_FOUND:break;case Dropbox.ApiError.OVER_QUOTA:break;case Dropbox.ApiError.RATE_LIMITED:break;case Dropbox.ApiError.NETWORK_ERROR:break;case Dropbox.ApiError.INVALID_PARAM:case Dropbox.ApiError.OAUTH_ERROR:case Dropbox.ApiError.INVALID_METHOD:}};e.exports=n},{}],2:[function(t,e,i){"use strict";function n(t){var e=-1,i=[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"];do t/=1024,e++;while(t>1024);return Math.max(t,.1).toFixed(1)+i[e]}var r=function(t){this.root=t,this.hue=d3.scale.category10(),this.luminance=d3.scale.sqrt().domain([0,1e7]).clamp(!0).range([90,20]),this.initialize()};r.prototype={constructor:r,initialize:function(){var t={top:350,right:480,bottom:350,left:480},e=Math.min(t.top,t.right,t.bottom,t.left)-10;this.tip=d3.tip().attr("class","d3-tip").direction("w").offset([0,-5]).html(function(t){return t.name+": "+n(t.size)});var i=d3.select("#content").append("svg").call(this.tip).attr("width",t.left+t.right).attr("height",t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");this.partition=d3.layout.partition().sort(function(t,e){return d3.ascending(t.size,e.size)}).size([2*Math.PI,e]),this.arc=d3.svg.arc().startAngle(function(t){return t.x}).endAngle(function(t){return t.x+t.dx-.01/(t.depth+.5)}).innerRadius(function(t){return e/3*t.depth}).outerRadius(function(t){return e/3*(t.depth+1)-1}),this.partition.value(function(t){return t.size}),this.center=new r.Center(i.append("g"),this.root,e,this.zoomOut.bind(this)),this.path=i.selectAll("path"),this.update(),d3.select(self.frameElement).style("height",t.top+t.bottom+"px")},zoomIn:function(t){t.depth>1&&(t=t.parent),t.children&&this.zoomToRoot(t,t)},zoomOut:function(t){t.parent&&this.zoomToRoot(t.parent,t)},zoomToRoot:function(t,e){function i(t){return e.key>t.key?{depth:t.depth-1,x:0,dx:0}:e.key<t.key?{depth:t.depth-1,x:2*Math.PI,dx:0}:{depth:0,x:0,dx:2*Math.PI}}function n(t){return{depth:t.depth+1,x:h(t.x),dx:h(t.x+t.dx)-h(t.x)}}function r(t){var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return c.arc(e(t))}}function o(t){return{depth:t.depth,x:t.x,dx:t.dx}}if(!document.documentElement.__transition__){var a,s,h=d3.scale.linear().domain([0,2*Math.PI]);this.center.update(t),t===e&&(a=n,s=i,h.range([e.x,e.x+e.dx])),this.path=this.path.data(this.partition.nodes(t).slice(1),function(t){return t.key}),t!==e&&(a=i,s=n,h.range([e.x,e.x+e.dx]));var c=this;d3.transition().duration(d3.event.altKey?7500:750).each(function(){c.path.exit().transition().style("fill-opacity",function(i){return i.depth===1+(t===e)?1:0}).attrTween("d",function(t){return r.call(this,s(t))}).remove(),c.path.enter().append("path").style("fill-opacity",function(i){return i.depth===2-(t===e)?1:0}).style("fill",function(t){return t.fill}).on("click",c.zoomIn.bind(c)).each(function(t){this._current=a(t)}),c.path.on("mouseover",c.tip.show).on("mouseout",c.tip.hide),c.path.transition().style("fill-opacity",1).attrTween("d",function(t){return r.call(this,o(t))})})}},update:function(){function t(t){for(var e=t;e.depth>1;)e=e.parent;var n=d3.lab(i.hue(e.name));return n.l=i.luminance(t.size),n}function e(t){return{depth:t.depth,x:t.x,dx:t.dx}}var i=this;this.partition.nodes(this.root).forEach(function(t){t._children=t.__children}),this.partition.children(function(t){return t._children}),this.partition.nodes(this.root).forEach(function(e){e.fill=t(e)}),this.partition.children(function(t,e){return 2>e?t._children:null}),this.path=this.path.data(this.partition.nodes(this.root).slice(1),function(t){return t.key}),this.path.enter().append("path").attr("d",this.arc).on("click",this.zoomIn.bind(this)),this.path.attr("d",this.arc).style("fill",function(t){return t.fill}).each(function(t){this._current=e(t)}).on("mouseover",this.tip.show).on("mouseout",this.tip.hide),this.path.exit().remove()}},r.Center=function(t,e,i,n){this.rootNode=t,this.dataRoot=e,this.initialize(i,n)},r.Center.prototype={constructor:r.Center,initialize:function(t,e){this.center=this.rootNode.append("circle").attr("r",t/3).on("click",e),this.center.append("title").text("zoom out"),this.centerFolderName=this.rootNode.append("text").attr("class","centerText").attr("id","centerFolderName"),this.centerFolderSize=this.rootNode.append("text").attr("class","centerText").attr("id","centerFolderSize").attr("dy",28),this.centerLinkGroup=this.rootNode.append("g"),this.centerLinkGroup.append("text").attr("dy",48).attr("dx",-75).attr("class","centerText").attr("font-family","FontAwesome").text(""),this.centerLink=this.centerLinkGroup.append("a").attr("target","_blank"),this.centerLink.append("text").attr("class","centerText").attr("id","centerLink").attr("dx",5).attr("dy",47).text("Open in your Dropbox"),this.update(this.dataRoot)},update:function(t){this.center.datum(t),this.centerFolderName.text(t.name.trunc(20,2)),this.centerFolderSize.text(n(t.size)),this.centerLink.attr("xlink:href","http://www.dropbox.com/home"+t.getPath())}},e.exports=r},{}],3:[function(t,e,i){"use strict";function n(){d.authenticate({interactive:!1},function(t,e){return t?l(t):void(e.isAuthenticated()?r():($("#dropbox-connect").show(),$(".btn-dropbox").click(function(){e.authenticate(function(t){return t?l(t):void r()})})))})}function r(){$("#dropbox-connect").hide(),$("#progress-box").show();var t=0;d.getAccountInfo(function(e,i){t=i.usedQuota,console.log(t)});var e=new h("home");_(e,void 0,function(){setTimeout(function(){$("#progress-box").hide(),$("#hint").show(),a(e)},300)},function(i){if(0!=t){i&&o(e,t-i);var n=Math.round(1e4*i/t)/100;$("#progress-bar").text(n+"%"),$("#progress-bar").css("width",n+"%")}},0,5e5)}function o(t,e){var i=Date.now();u&&100>i-u||(u=i,t.addChild("waiting",e),t.computeSize(),t.pruneSmallFiles(v),t.computeSize(),t.publishChildren(),s?s.update():s=new c(t),t.removeChild("waiting",e))}function a(t){t.computeSize(),t.pruneSmallFiles(v),t.computeSize(),t.publishChildren(),s?s.update():s=new c(t)}var s,h=t("./tree").Tree,c=t("./graph"),l=t("./errorHandler"),d=new Dropbox.Client({key:"f629oxf1xdmgu0g"}),p="joplapp.github.io";p==window.location.host&&"https:"!=window.location.protocol&&(window.location.protocol="https"),$(document).ready(n),$(document).ready(function(){$("#privacy-policy-link").click(function(t){$("#privacy-policy").toggle(),t.preventDefault(),$("html, body").animate({scrollTop:$(document).height()},"slow")})});var u,f=function(t,e,i,n){for(var r,o=e.split("/"),a=t,s=1;s<o.length-1;s++)r=a.getNode(o[s]),r||(r=a.addNode(o[s])),a=r;a[i](o.pop(),n)},m=function(t,e){f(t,e,"addNode")},x=function(t,e,i){f(t,e,"addChild",i)},_=function(t,e,i,n,r,o){return n(r),0>o?void i():void d.delta(e,function(e,a){return a.changes?(a.changes.forEach(function(e){e.stat.isFolder?m(t,e.path):(x(t,e.path,e.stat.size),r+=e.stat.size)}),void(a.shouldPullAgain?_(t,a.cursorTag,i,n,r,o-a.changes.length):i())):void i()})},v=25;String.prototype.trunc=function(t,e){return e=e||0,this.length>t?this.substr(0,t-(1+e))+"…"+this.substr(-e,e):this}},{"./errorHandler":1,"./graph":2,"./tree":4}],4:[function(t,e,i){"use strict";var n=0,r=function(t,e){this.name=t,this.size=e,this.key=n++},o=function(t){this.__children=[],this.leaves=[],this.dict={},this.name=t,this.size=0,this.key=n++,this.__removedSmallChildren=[],this.__smallChildrenContainer=null};o.prototype.getPath=function(){return this.parent?(console.log("bla: "+this.parent.getPath()+"/"+this.name),this.parent.getPath()+"/"+this.name):""},o.prototype.addNode=function(t){var e=new o(t);return this.__children.push(e),this.dict[t]=e,e},o.prototype.addChild=function(t,e){var i=new r(t,e);return this.__children.push(i),this.leaves.push(i),i},o.prototype.removeChild=function(t){var e;this.__children.forEach(function(i){i.name==t&&(e=i)}),e&&(this.__children.splice(this.__children.indexOf(e),1),this.leaves.splice(this.leaves.indexOf(e),1))},o.prototype.getXLargestChildrenSize=function(t){var e=this.leaves.map(function(t){return t.size}),i=function(t,e){return t==e?0:t>e?-1:1};return e=e.sort(i),e.length>t?e[t]:0},o.prototype.getNode=function(t){return this.dict[t]},o.prototype.computeSize=function(){var t=0;return this.__children.forEach(function(e){t+=e instanceof r?e.size:e.computeSize()}),this.size=t,t},o.prototype.publishChildren=function(){this.children=this.__children,this.__children.forEach(function(t){t instanceof r||t.publishChildren()})},o.prototype.reAddSmallFiles=function(){this.__removedSmallChildren.length&&(Array.prototype.push.apply(this.__children,this.__removedSmallChildren),Array.prototype.push.apply(this.leaves,this.__removedSmallChildren),this.__removedSmallChildren.length=0,this.__children.splice(this.__children.indexOf(this.__smallChildrenContainer),1),this.leaves.splice(this.leaves.indexOf(this.__smallChildrenContainer),1))},o.prototype.pruneSmallFiles=function(t){this.__children.forEach(function(e){e instanceof r||e.pruneSmallFiles(t)}),this.reAddSmallFiles();for(var e=this.getXLargestChildrenSize(t),i=0,n=0,o=0;o<this.leaves.length;o++){var a=this.leaves[o];a.size<=e&&(i++,n+=a.size,this.__children.splice(this.__children.indexOf(a),1),this.leaves.splice(o,1),this.__removedSmallChildren.push(a),o--)}i&&(this.__smallChildrenContainer=this.addChild(i+" small files",n))},e.exports={Tree:o,Leaf:r}},{}]},{},[3]);
//# sourceMappingURL=app.js.map
